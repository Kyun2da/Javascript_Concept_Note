# 프로토타입

자바스크립트에서 클래스 문법은 ES6 이후에 등장하게 되었다.

하지만 그 이전에도 클래스와 비슷한 동작을 프로토 타입을 사용해서 사용하고 있었다.

이 때문에 자바스크립트는 **프로토타입 기반의 객체지향 프로그래밍 언어**라고도 한다.

객체지향 프로그래밍 언어를 구현하기 위해서는 **상속**이라는 개념의 구현이 절대적으로 필요하다.

이러한 상속 개념을 자바스크립트는 프로토타입을 이용해 표현한다.



## 프로토타입의 정의

그렇다면 프로토타입은 정확히 무엇일까?

프로토타입 객체(줄여서 프로토타입)란 객체지향 프로그래밍의 근간을 이루는 객체 간 상속을 구현하기 위해 사용한다. 프로토 타입은 어떤 객체의 부모 객체 역할을 하는 객체로서 다른 객체에 공유 프로퍼티(메서드 포함)를 제공한다.



모든 객체는 [[Prototype]] 이라는 내부 슬롯을 가지며, 이 내부 슬롯의 값은 프로토타입의 참조이다.

또한 __ proto __ 접근자 프로퍼티를 통해 자신의 프로토타입, 즉 자신의 [[Prototype]] 내부 슬롯이 가리키는 프로토타입에 간접적으로 접근할 수 있다.

하지만 직접 상속과 같은 방법을 통해 Object.prototype을 상속받지 않는 객체를 생성할 수 있기 때문에 __ proto __ 접근자 프로퍼티를 코드 내에서 사용하는 것은 권장하지 않는다. 대신 프로토타입의 참조를 취득하고 싶다면 Object.getPrototypeOf 메서드를 사용하고, 프로토타입을 교체하고 싶다면 Object.setPrototypeOf 메서드를 사용하도록 하자.



## __ proto __ 접근자 프로퍼티와 prototype 프로퍼티의 비교

두 프로퍼티는 동일한 프로토타입을 가리키지만 사용하는 주체가 다르다. 표를 통해 비교해보자.

|    구분     |    소유     |        값         |  사용 주체  |                          사용 목적                           |
| :---------: | :---------: | :---------------: | :---------: | :----------------------------------------------------------: |
| __ proto __ |  모든 객체  | 프로토타입의 참조 |  모든 객체  |   객체가 자신의 프로토타입에 접근 또는 교체하기 위해 사용    |
|  prototype  | constructor | 프로토타입의 참조 | 생성자 함수 | 생성자 함수가 자신이 생성할 객체(인스턴스)의 프로토타입을 할당하기 위해 사용 |

표만 봐서는 이해가 되지 않을 수 있으니 코드를 통해 비교해보자



```js
// 생성자 함수
function Person(name){
    this.name = name;
}

const me = new Person('Lee');

// 결국 Person.prototype과 me.__proto__는 결국 동일한 프로토타입을 가리킨다.
console.log(Person.prototype === me.__proto__); // true
```



## 프로토타입의 생성 시점

프로토타입은 생성자 함수가 생성되는 시점에 더불어 생성된다. 프로토타입과 생성자 함수는 단독으로 존재할 수 없고 언제나 쌍으로 존재하기 때문이다.



또한 생성자함수가 생성되는 시점은 사용자 정의 생성자함수와 빌트인 생성자 함수의 두가지 경우가 있다. 이 두가지 경우를 살펴보도록 하자.

1. 사용자 정의 생성자 함수와 프로토 타입 생성 시점

   ```js
   // 함수 정의(constructor)가 평가되어 함수 객체를 생성하는 시점에 프로토타입도 더불어 생성된다.
   console.log(Person.prototype); // {constructor: f}
   
   // 생성자 함수
   function Person(name) {
       this.name = name;
   }
   ```

   생성자 함수로서 호출할 수 있는 함수, 즉 constructor는 함수 정의가 평가되어 함수 객체를 생성하는 시점에 프로토타입도 더불어 생성된다.

2.  빌트인 생성자 함수와 프로토타입 생성 시점

   여기서 빌트인생성자 함수는 Object, String, Number, Function, Array와 같은 미리 생성되어 있는 함수를 말한다.

   모든 빌트인 생성자 함수는 전역 객체가 생성되는 시점에 생성된다. 생성된 프로토타입은 빌트인 생성자 함수의 prototype 프로퍼티에 바인딩된다.



## 객체 생성 방식과 프로토타입 결정

객체를 생성하는 방법

- 객체 리터럴

  ```js
  const obj = { x: 1 };
  ```

  

- Object 생성자 함수

  ```js
  const obj = new Object();
  obj.x = 1;
  ```

  

- 생성자 함수

  ```js
  function Person(name) {
      this.name = name;
  }
  
  const me = new Person('Lee');
  ```

  

- Object.create 메서드

- 클래스(ES6)



## 프로토타입 체인

자바스크립트는 객체의 프로퍼티(메서드 포함)에 접근하려고 할 때 해당 객체에 접근하려는 프로퍼티가 없다면 [[Prototype]] 내부 슬롯의 참조를 따라 자신의 부모 역할을 하는 프로토타입의 프로퍼티를 순차적으로 검색한다. 이를 프로토타입 체인이라고 한다. 프로토타입 체인은 자바스크립트가 객체지향 프로그래밍의 상속을 구현하는 메커니즘이다.



















